<!--VERSION: 35-->

<section id="eda-bom-converter" style="border-radius: 14px; border: 1px solid rgb(229, 231, 235); font-family: system-ui, -apple-system, &quot;Segoe UI&quot;, Roboto, Arial, sans-serif; max-width: 1040px; margin: 18px auto; padding: 16px;">
  <h1 style="margin: 0 0 8px 0; font-size: 22px;">PADS BOM Converter for Digi-Key and Mouser</h1>

  <p style="margin: 0 0 10px 0; color: #374151;">
    <strong>Status:</strong> Active (MVP). Supports <strong>Upload → Preview → Header selection → Auto-detect + dropdown override → Convert</strong>.
  </p>

  <p style="margin: 0 0 12px 0; color: #374151;">
    This page embeds a lightweight BOM converter (Google Apps Script Web App). Upload your BOM, confirm the header row, map columns if needed, then download an upload-friendly XLSX.
  </p>

  <hr style="border: 0; border-top: 1px solid #e5e7eb; margin: 14px 0;" />

  <div style="display:flex; flex-wrap:wrap; gap:10px; align-items:center; margin: 10px 0 12px 0;">
    <a href="https://www.digikey.com/en/resources/bom-tool" target="_blank" rel="nofollow"
       style="display:inline-block; padding:10px 12px; border-radius:12px; background:#111827; color:#fff; text-decoration:none; font-weight:700;">
      Digi-Key BOM Tool
    </a>
    <a href="https://www.mouser.com/bom/" target="_blank" rel="nofollow"
       style="display:inline-block; padding:10px 12px; border-radius:12px; background:#1d4ed8; color:#fff; text-decoration:none; font-weight:700;">
      Mouser BOM Tool
    </a>

    <span style="font-size:12px; color:#6b7280;">
      Tip: If the embed looks small, open the converter in a new tab.
    </span>
  </div>

  <div style="border:1px solid #e5e7eb; border-radius:14px; overflow:hidden;">
    <div style="background:#f9fafb; padding:10px 12px; font-weight:700; color:#111827;">
      Embedded Converter
    </div>

    <!-- IMPORTANT: Web App URL injected here -->
    <iframe
      id="bomConvFrame"
      src="https://script.google.com/macros/s/AKfycbxYNm57DQNLaGaO_tvhNocL5YUAiMWbnKSRT9YSvn5g5IUWcCZRI4HapfKib_DjxGTjiA/exec"
      style="width:100%; height: 980px; border:0; display:block;"
      loading="lazy"
      referrerpolicy="no-referrer-when-downgrade"
      allow="clipboard-read; clipboard-write"
    ></iframe>
  </div>

  <div style="margin-top: 12px; padding: 12px; border-radius: 12px; background: #f9fafb; border: 1px solid #e5e7eb; color:#374151; font-size: 13px; line-height: 1.5;">
    <strong>Notes</strong>
    <ul style="margin: 8px 0 0 18px;">
      <li>For best results, your BOM should include at least: <strong>MPN(Part Number)</strong> and <strong>QTY</strong>.</li>
      <li>If your XLSX has merged cells or formatting issues, exporting as <strong>CSV</strong> often works best.</li>
      <li>This MVP stores temporary files in Google Drive during conversion. Use reset inside the tool if needed.</li>
    </ul>
  </div>
</section>

<script>
  // Optional: Auto-resize iframe by receiving postMessage from the embedded app
  // The embedded index.html sends { type:"BOM_CONVERTER_HEIGHT", height: ... }
  (function(){
    const frame = document.getElementById('bomConvFrame');
    if(!frame) return;

    window.addEventListener('message', function(ev){
      try{
        const data = ev.data || {};
        if(data && data.type === 'BOM_CONVERTER_HEIGHT' && typeof data.height === 'number'){
          // Add a small padding
          const h = Math.max(680, Math.min(2400, data.height + 40));
          frame.style.height = h + 'px';
        }
      }catch(e){}
    });
  })();
</script>
